syntax = "proto3";
package events;

service Events {
    // Send an event
    rpc TriggerEvent(TriggerEventRequest) returns (TriggerEventResponse);

    // Get an event
    rpc GetEvent(GetEventRequest) returns (GetEventResponse);

    // Post update
    // rpc PostExecutionUpdate(PostExecutionUpdateRequest) returns (PostExecutionUpdateResponse);

    // Register flow for execution
    // rpc SubscribeFlow(SubscribeFlowRequest) returns (stream SubscribeFlowResponse);
}

message EventIdentifier {
    int64 id = 1;
}

message SourceIdentifier {
    int64 source_id = 1;
}

message EventDetails {
    // Event name, like file-watcher/changed
    string name = 2;
    // Event payload
    string payload = 1;
    repeated string tags = 3;
    optional string metadata = 4;
}

message Event {
    SourceIdentifier identifier = 1;
    EventDetails details = 2;
}

message TriggerEventRequest {
    Event event = 1;
}
message TriggerEventResponse {
    string status = 1;
    int64 event_id = 2;
}

message GetEventRequest {
    EventIdentifier id = 1;
}

message GetEventResponse {
    Event event = 1;
}