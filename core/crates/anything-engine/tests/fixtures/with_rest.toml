name = "Get the weather"
version = "0.1"
description = "A flow to get the current weather"

[trigger]
name = "Manual"

[trigger.settings]

[[nodes]]
name = "getweather"
label = "Get the current weather"
variables = [{ lat = "37.386", lon = "-122.0838" }]

[nodes.action]
action_type = "REST"

[nodes.action.config]
query_params = [{ "timezone" = "PST" }]

url = "https://api.open-meteo.com/v1/forecast?latitude={{lat}}&longitude={{lon}}"
method = "GET"
headers = [{ "x-api-key" = "1234567890" }]
body = ""
response_type = "JSON"
[[nodes]]
name = "echoweather"
label = "Tell us the weather"
variables = [{ weather = "{{getweather.stdout|json_encode}}" }]
depends_on = ["getweather"]

[nodes.action]
action_type = "Shell"

[nodes.action.config]
command = "echo {{weather}}"
